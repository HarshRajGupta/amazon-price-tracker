"use strict";(()=>{var e={};e.id=557,e.ids=[557],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5462:e=>{e.exports=import("puppeteer")},9491:e=>{e.exports=require("assert")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},8342:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>g,patchFetch:()=>u,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var i=r(884),n=r(6132),o=r(1040),s=r(5514),l=e([s]);s=(l.then?(await l)():l)[0];let c=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/cron/route",pathname:"/api/cron",filename:"route",bundlePath:"app/api/cron/route"},resolvedPagePath:"C:\\Users\\Harsh\\Code\\pricewise\\app\\api\\cron\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:p,headerHooks:f,staticGenerationBailout:m}=c,g="/api/cron/route";function u(){return(0,o.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:h})}a()}catch(e){a(e)}})},5514:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{GET:()=>p});var i=r(4600);r(1639);var n=r(5335),o=r(8590),s=r(6070),l=r(3008),u=r(3935),c=r(5798),d=r(2990),h=e([l]);async function p(e){try{(0,o.connectToDB)();let e=await n.Z.find({});if(!e)throw Error("No product fetched");let t=await Promise.all(e.map(async e=>{let t=await (0,l.scrapeAmazonProduct)(e?.url);if(!t)return;let r=[...e?.priceHistory,{price:t?.currentPrice||0}],a={...t,priceHistory:r,lowestPrice:(0,u.nd)(r)||0,highestPrice:(0,u.TF)(r)||0,averagePrice:(0,u.bd)(r)||0},i=await n.Z.findOneAndUpdate({url:a?.url},a),o=(0,u.Ux)(t,e);if(o&&i.users.length>0){let e={title:i?.title,url:i?.url},t=await (0,s.generateEmailBody)(e,o),r=i.users.map(e=>e?.email);await (0,s.sendEmail)(t,r)}return i}));return c.Z.json({message:"Ok",data:t})}catch(e){throw Error(`Failed to get all products: ${e.message}`)}}l=(h.then?(await h)():h)[0],(0,d.h)([p]),(0,i.U)("d29e2996a6c4ae100ca5839ca78d60ddff38e971",null,p),a()}catch(e){a(e)}})},5335:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(1185),i=r.n(a);let n=new(i()).Schema({url:{type:String,required:!0,unique:!0},currency:{type:String,required:!0},image:{type:String,required:!0},title:{type:String,required:!0},currentPrice:{type:Number,required:!0},originalPrice:{type:Number,required:!0},priceHistory:[{price:{type:Number,required:!0},date:{type:Date,default:Date.now}}],lowestPrice:{type:Number},highestPrice:{type:Number},averagePrice:{type:Number},discountRate:{type:Number},description:{type:String},category:{type:String},reviewsCount:{type:Number},isOutOfStock:{type:Boolean,default:!1},users:[{email:{type:String,required:!0}}],default:[]},{timestamps:!0}),o=i().models.Product||i().model("Product",n),s=o},8590:(e,t,r)=>{r.r(t),r.d(t,{connectToDB:()=>l});var a=r(4600);r(1639);var i=r(1185),n=r.n(i),o=r(2990);let s=!1,l=async()=>{if(n().set("strictQuery",!0),!process.env.MONGODB_URI)return console.log("MONGODB_URI is not defined");if(s)return console.log("=> using existing database connection");try{await n().connect(process.env.MONGODB_URI),s=!0,console.log("MongoDB Connected")}catch(e){console.log(e)}};(0,o.h)([l]),(0,a.U)("4598a7dc80fd52ddb9fbd43121e348c49402ad80",null,l)},6070:(e,t,r)=>{r.r(t),r.d(t,{generateEmailBody:()=>o,sendEmail:()=>l});var a=r(4600);r(1639);var i=r(6709),n=r(2990);let Notification={WELCOME:"WELCOME",CHANGE_OF_STOCK:"CHANGE_OF_STOCK",LOWEST_PRICE:"LOWEST_PRICE",THRESHOLD_MET:"THRESHOLD_MET"};async function o(e,t){let r=e.title.length>20?`${e.title.substring(0,20)}...`:e.title,a="",i="";switch(t){case Notification.WELCOME:a=`Welcome to Price Tracking for ${r}`,i=`
        <div>
          <h2>Welcome to PriceWise ðŸš€</h2>
          <p>You are now tracking ${e.title}.</p>
          <p>Here's an example of how you'll receive updates:</p>
          <div style="border: 1px solid #ccc; padding: 10px; background-color: #f8f8f8;">
            <h3>${e.title} is back in stock!</h3>
            <p>We're excited to let you know that ${e.title} is now back in stock.</p>
            <p>Don't miss out - <a href="${e.url}" target="_blank" rel="noopener noreferrer">buy it now</a>!</p>
            <img src="https://i.ibb.co/pwFBRMC/Screenshot-2023-09-26-at-1-47-50-AM.png" alt="Product Image" style="max-width: 100%;" />
          </div>
          <p>Stay tuned for more updates on ${e.title} and other products you're tracking.</p>
        </div>
      `;break;case Notification.CHANGE_OF_STOCK:a=`${r} is now back in stock!`,i=`
        <div>
          <h4>Hey, ${e.title} is now restocked! Grab yours before they run out again!</h4>
          <p>See the product <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a>.</p>
        </div>
      `;break;case Notification.LOWEST_PRICE:a=`Lowest Price Alert for ${r}`,i=`
        <div>
          <h4>Hey, ${e.title} has reached its lowest price ever!!</h4>
          <p>Grab the product <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a> now.</p>
        </div>
      `;break;case Notification.THRESHOLD_MET:a=`Discount Alert for ${r}`,i=`
        <div>
          <h4>Hey, ${e.title} is now available at a discount more than 40%!</h4>
          <p>Grab it right away from <a href="${e.url}" target="_blank" rel="noopener noreferrer">here</a>.</p>
        </div>
      `;break;default:throw Error("Invalid notification type.")}return{subject:a,body:i}}let s=i.createTransport({pool:!0,service:"hotmail",port:2525,auth:{user:"javascriptmastery@outlook.com",pass:process.env.EMAIL_PASSWORD},maxConnections:1}),l=async(e,t)=>{let r={from:"javascriptmastery@outlook.com",to:t,html:e.body,subject:e.subject};s.sendMail(r,(e,t)=>{if(e)return console.log(e);console.log("Email sent: ",t)})};(0,n.h)([o,l]),(0,a.U)("51c8210eb4e790ec9e849881f02ff08161c57c72",null,o),(0,a.U)("3c866c6a3974178969123cfb21cce2e4748a01cd",null,l)},3008:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{scrapeAmazonProduct:()=>d,scrapeAmazonProducts:()=>h});var i=r(4600);r(1639);var n=r(700),o=r(4310),s=r(5462),l=r(3935),u=r(2990),c=e([s]);async function d(e){if(!e)return;let t=await s.default.launch({headless:"new"}),r=await t.newPage();try{await r.goto(e);let t=await r.content(),a=o.zD(t),i=a("#productTitle").text().trim(),n=(0,l.EL)(a(".priceToPay span.a-price-whole"),a(".a.size.base.a-color-price"),a(".a-button-selected .a-color-base")),s=(0,l.EL)(a("#priceblock_ourprice"),a(".a-price.a-text-price span.a-offscreen"),a("#listPrice"),a("#priceblock_dealprice"),a(".a-size-base.a-color-price")),u="currently unavailable"===a("#availability span").text().trim().toLowerCase(),c=a("#imgBlkFront").attr("data-a-dynamic-image")||a("#landingImage").attr("data-a-dynamic-image")||"{}",d=Object.keys(JSON.parse(c)),h=(0,l.Eq)(a(".a-price-symbol")),p=a(".savingsPercentage").text().replace(/[-%]/g,""),f=(0,l.B0)(a),m={url:e,currency:h||"$",image:d[0],title:i,currentPrice:Number(n)||Number(s),originalPrice:Number(s)||Number(n),priceHistory:[],discountRate:Number(p),category:"category",reviewsCount:100,stars:4.5,isOutOfStock:u,description:f,lowestPrice:Number(n)||Number(s),highestPrice:Number(s)||Number(n),averagePrice:Number(n)||Number(s)};return m}catch(e){console.log(e)}}async function h(e){if(!e)return;let t=String(process.env.BRIGHT_DATA_USERNAME),r=String(process.env.BRIGHT_DATA_PASSWORD),a={auth:{username:`${t}-session-${1e6*Math.random()|0}`,password:r},host:"brd.superproxy.io",port:22225,rejectUnauthorized:!1};try{let t=await n.Z.get(e,a),r=o.zD(t.data),i=r("#productTitle").text().trim(),s=(0,l.EL)(r(".priceToPay span.a-price-whole"),r(".a.size.base.a-color-price"),r(".a-button-selected .a-color-base")),u=(0,l.EL)(r("#priceblock_ourprice"),r(".a-price.a-text-price span.a-offscreen"),r("#listPrice"),r("#priceblock_dealprice"),r(".a-size-base.a-color-price")),c="currently unavailable"===r("#availability span").text().trim().toLowerCase(),d=r("#imgBlkFront").attr("data-a-dynamic-image")||r("#landingImage").attr("data-a-dynamic-image")||"{}",h=Object.keys(JSON.parse(d)),p=(0,l.Eq)(r(".a-price-symbol")),f=r(".savingsPercentage").text().replace(/[-%]/g,""),m=(0,l.B0)(r),g={url:e,currency:p||"$",image:h[0],title:i,currentPrice:Number(s)||Number(u),originalPrice:Number(u)||Number(s),priceHistory:[],discountRate:Number(f),category:"category",reviewsCount:100,stars:4.5,isOutOfStock:c,description:m,lowestPrice:Number(s)||Number(u),highestPrice:Number(u)||Number(s),averagePrice:Number(s)||Number(u)};return g}catch(e){console.log(e)}}s=(c.then?(await c)():c)[0],(0,u.h)([d,h]),(0,i.U)("4d509df74e5fa9ae8d96a6f9bc794ed73dd5d867",null,d),(0,i.U)("a306b56c562f0fb6cf5dca0e49e5a33d4a818327",null,h),a()}catch(e){a(e)}})},3935:(e,t,r)=>{r.d(t,{B0:()=>n,EL:()=>a,Eq:()=>i,TF:()=>o,Ux:()=>u,bd:()=>l,nd:()=>s,uf:()=>c});let Notification={CHANGE_OF_STOCK:"CHANGE_OF_STOCK",LOWEST_PRICE:"LOWEST_PRICE",THRESHOLD_MET:"THRESHOLD_MET"};function a(...e){for(let t of e){let e=t.text().trim();if(e){let t;let r=e.replace(/[^\d.]/g,"");return r&&(t=r.match(/\d+\.\d{2}/)?.[0]),t||r}}return""}function i(e){let t=e.text().trim().slice(0,1);return t||""}function n(e){for(let t of[".a-unordered-list .a-list-item",".a-expander-content p"]){let r=e(t);if(r.length>0){let t=r.map((t,r)=>e(r).text().trim()).get().join("\n");return t}}return""}function o(e){let t=e[0];for(let r=0;r<e.length;r++)e[r].price>t.price&&(t=e[r]);return t.price}function s(e){let t=e[0];for(let r=0;r<e.length;r++)e[r].price<t.price&&(t=e[r]);return t.price}function l(e){let t=e.reduce((e,t)=>e+t.price,0),r=t/e.length||0;return r}let u=(e,t)=>{let r=s(t.priceHistory);return e.currentPrice<r?Notification.LOWEST_PRICE:!e.isOutOfStock&&t.isOutOfStock?Notification.CHANGE_OF_STOCK:e.discountRate>=40?Notification.THRESHOLD_MET:null},c=(e=0)=>e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})},989:e=>{var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={};function o(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean);return`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}; ${r.join("; ")}`}function s(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[a,i]=[r.slice(0,e),r.slice(e+1)];try{t.set(a,decodeURIComponent(null!=i?i:"true"))}catch{}}return t}function l(e){var t,r;if(!e)return;let[[a,i],...n]=s(e),{domain:o,expires:l,httponly:d,maxage:h,path:p,samesite:f,secure:m,priority:g}=Object.fromEntries(n.map(([e,t])=>[e.toLowerCase(),t])),b={name:a,value:decodeURIComponent(i),domain:o,...l&&{expires:new Date(l)},...d&&{httpOnly:!0},..."string"==typeof h&&{maxAge:Number(h)},path:p,...f&&{sameSite:u.includes(t=(t=f).toLowerCase())?t:void 0},...m&&{secure:!0},...g&&{priority:c.includes(r=(r=g).toLowerCase())?r:void 0}};return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}(b)}((e,r)=>{for(var a in r)t(e,a,{get:r[a],enumerable:!0})})(n,{RequestCookies:()=>d,ResponseCookies:()=>h,parseCookie:()=>s,parseSetCookie:()=>l,stringifyCookie:()=>o}),e.exports=((e,n,o,s)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let o of a(n))i.call(e,o)||void 0===o||t(e,o,{get:()=>n[o],enumerable:!(s=r(n,o))||s.enumerable});return e})(t({},"__esModule",{value:!0}),n);var u=["strict","lax","none"],c=["low","medium","high"],d=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t){let e=s(t);for(let[t,r]of e)this._parsed.set(t,{name:t,value:r})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===a).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,a=this._parsed;return a.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(a).map(([e,t])=>o(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>o(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},h=class{constructor(e){var t,r,a;this._parsed=new Map,this._headers=e;let i=null!=(a=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?a:[],n=Array.isArray(i)?i:function(e){if(!e)return[];var t,r,a,i,n,o=[],s=0;function l(){for(;s<e.length&&/\s/.test(e.charAt(s));)s+=1;return s<e.length}for(;s<e.length;){for(t=s,n=!1;l();)if(","===(r=e.charAt(s))){for(a=s,s+=1,l(),i=s;s<e.length&&"="!==(r=e.charAt(s))&&";"!==r&&","!==r;)s+=1;s<e.length&&"="===e.charAt(s)?(n=!0,s=i,o.push(e.substring(t,a)),t=s):s=a+1}else s+=1;(!n||s>=e.length)&&o.push(e.substring(t,e.length))}return o}(i);for(let e of n){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===a)}has(e){return this._parsed.has(e)}set(...e){let[t,r,a]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...a})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=o(r);t.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let[t,r,a]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:r,domain:a,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(o).join("; ")}}},884:(e,t,r)=>{e.exports=r(517)},5798:(e,t,r)=>{Object.defineProperty(t,"Z",{enumerable:!0,get:function(){return a.NextResponse}});let a=r(3172)},6863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextURL",{enumerable:!0,get:function(){return c}});let a=r(5331),i=r(9387),n=r(3490),o=r(470),s=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function l(e,t){return new URL(String(e).replace(s,"localhost"),t&&String(t).replace(s,"localhost"))}let u=Symbol("NextURLInternal");class c{constructor(e,t,r){let a,i;"object"==typeof t&&"pathname"in t||"string"==typeof t?(a=t,i=r||{}):i=r||t||{},this[u]={url:l(e,a??i.base),options:i,basePath:""},this.analyze()}analyze(){var e,t,r,i,s;let l=(0,o.getNextPathnameInfo)(this[u].url.pathname,{nextConfig:this[u].options.nextConfig,parseData:!0,i18nProvider:this[u].options.i18nProvider}),c=(0,n.getHostname)(this[u].url,this[u].options.headers);this[u].domainLocale=this[u].options.i18nProvider?this[u].options.i18nProvider.detectDomainLocale(c):(0,a.detectDomainLocale)(null==(t=this[u].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,c);let d=(null==(r=this[u].domainLocale)?void 0:r.defaultLocale)||(null==(s=this[u].options.nextConfig)?void 0:null==(i=s.i18n)?void 0:i.defaultLocale);this[u].url.pathname=l.pathname,this[u].defaultLocale=d,this[u].basePath=l.basePath??"",this[u].buildId=l.buildId,this[u].locale=l.locale??d,this[u].trailingSlash=l.trailingSlash}formatPathname(){return(0,i.formatNextPathnameInfo)({basePath:this[u].basePath,buildId:this[u].buildId,defaultLocale:this[u].options.forceLocale?void 0:this[u].defaultLocale,locale:this[u].locale,pathname:this[u].url.pathname,trailingSlash:this[u].trailingSlash})}formatSearch(){return this[u].url.search}get buildId(){return this[u].buildId}set buildId(e){this[u].buildId=e}get locale(){return this[u].locale??""}set locale(e){var t,r;if(!this[u].locale||!(null==(r=this[u].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[u].locale=e}get defaultLocale(){return this[u].defaultLocale}get domainLocale(){return this[u].domainLocale}get searchParams(){return this[u].url.searchParams}get host(){return this[u].url.host}set host(e){this[u].url.host=e}get hostname(){return this[u].url.hostname}set hostname(e){this[u].url.hostname=e}get port(){return this[u].url.port}set port(e){this[u].url.port=e}get protocol(){return this[u].url.protocol}set protocol(e){this[u].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[u].url=l(e),this.analyze()}get origin(){return this[u].url.origin}get pathname(){return this[u].url.pathname}set pathname(e){this[u].url.pathname=e}get hash(){return this[u].url.hash}set hash(e){this[u].url.hash=e}get search(){return this[u].url.search}set search(e){this[u].url.search=e}get password(){return this[u].url.password}set password(e){this[u].url.password=e}get username(){return this[u].url.username}set username(e){this[u].url.username=e}get basePath(){return this[u].basePath}set basePath(e){this[u].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new c(String(this),this[u].options)}}},6449:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RequestCookies:function(){return a.RequestCookies},ResponseCookies:function(){return a.ResponseCookies}});let a=r(989)},3172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return u}});let a=r(6863),i=r(6729),n=r(6449),o=Symbol("internal response"),s=new Set([301,302,303,307,308]);function l(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[a,i]of e.request.headers)t.set("x-middleware-request-"+a,i),r.push(a);t.set("x-middleware-override-headers",r.join(","))}}class u extends Response{constructor(e,t={}){super(e,t),this[o]={cookies:new n.ResponseCookies(this.headers),url:t.url?new a.NextURL(t.url,{headers:(0,i.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[o].cookies}static json(e,t){let r=Response.json(e,t);return new u(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!s.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let a="object"==typeof t?t:{},n=new Headers(null==a?void 0:a.headers);return n.set("Location",(0,i.validateURL)(e)),new u(null,{...a,headers:n,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",(0,i.validateURL)(e)),l(t,r),new u(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),l(e,t),new u(null,{...e,headers:t})}}},6729:(e,t)=>{function r(e){let t=new Headers;for(let[r,a]of Object.entries(e)){let e=Array.isArray(a)?a:[a];for(let a of e)void 0!==a&&("number"==typeof a&&(a=a.toString()),t.append(r,a))}return t}function a(e){var t,r,a,i,n,o=[],s=0;function l(){for(;s<e.length&&/\s/.test(e.charAt(s));)s+=1;return s<e.length}for(;s<e.length;){for(t=s,n=!1;l();)if(","===(r=e.charAt(s))){for(a=s,s+=1,l(),i=s;s<e.length&&"="!==(r=e.charAt(s))&&";"!==r&&","!==r;)s+=1;s<e.length&&"="===e.charAt(s)?(n=!0,s=i,o.push(e.substring(t,a)),t=s):s=a+1}else s+=1;(!n||s>=e.length)&&o.push(e.substring(t,e.length))}return o}function i(e){let t={},r=[];if(e)for(let[i,n]of e.entries())"set-cookie"===i.toLowerCase()?(r.push(...a(n)),t[i]=1===r.length?r[0]:r):t[i]=n;return t}function n(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{fromNodeOutgoingHttpHeaders:function(){return r},splitCookiesString:function(){return a},toNodeOutgoingHttpHeaders:function(){return i},validateURL:function(){return n}})},3490:(e,t)=>{function r(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getHostname",{enumerable:!0,get:function(){return r}})},5331:(e,t)=>{function r(e,t,r){if(e)for(let n of(r&&(r=r.toLowerCase()),e)){var a,i;let e=null==(a=n.domain)?void 0:a.split(":",1)[0].toLowerCase();if(t===e||r===n.defaultLocale.toLowerCase()||(null==(i=n.locales)?void 0:i.some(e=>e.toLowerCase()===r)))return n}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"detectDomainLocale",{enumerable:!0,get:function(){return r}})},182:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return n}});let a=r(2721),i=r(9203);function n(e,t,r,n){if(!t||t===r)return e;let o=e.toLowerCase();return!n&&((0,i.pathHasPrefix)(o,"/api")||(0,i.pathHasPrefix)(o,"/"+t.toLowerCase()))?e:(0,a.addPathPrefix)(e,"/"+t)}},2721:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathPrefix",{enumerable:!0,get:function(){return i}});let a=r(1193);function i(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:i,hash:n}=(0,a.parsePath)(e);return""+t+r+i+n}},9428:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathSuffix",{enumerable:!0,get:function(){return i}});let a=r(1193);function i(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:i,hash:n}=(0,a.parsePath)(e);return""+r+t+i+n}},9387:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatNextPathnameInfo",{enumerable:!0,get:function(){return s}});let a=r(4419),i=r(2721),n=r(9428),o=r(182);function s(e){let t=(0,o.addLocale)(e.pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix);return(e.buildId||!e.trailingSlash)&&(t=(0,a.removeTrailingSlash)(t)),e.buildId&&(t=(0,n.addPathSuffix)((0,i.addPathPrefix)(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=(0,i.addPathPrefix)(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:(0,n.addPathSuffix)(t,"/"):(0,a.removeTrailingSlash)(t)}},470:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getNextPathnameInfo",{enumerable:!0,get:function(){return o}});let a=r(5259),i=r(8200),n=r(9203);function o(e,t){var r,o;let{basePath:s,i18n:l,trailingSlash:u}=null!=(r=t.nextConfig)?r:{},c={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):u};s&&(0,n.pathHasPrefix)(c.pathname,s)&&(c.pathname=(0,i.removePathPrefix)(c.pathname,s),c.basePath=s);let d=c.pathname;if(c.pathname.startsWith("/_next/data/")&&c.pathname.endsWith(".json")){let e=c.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),r=e[0];c.buildId=r,d="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(c.pathname=d)}if(l){let e=t.i18nProvider?t.i18nProvider.analyze(c.pathname):(0,a.normalizeLocalePath)(c.pathname,l.locales);c.locale=e.detectedLocale,c.pathname=null!=(o=e.pathname)?o:c.pathname,!e.detectedLocale&&c.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(d):(0,a.normalizeLocalePath)(d,l.locales)).detectedLocale&&(c.locale=e.detectedLocale)}return c}},1193:(e,t)=>{function r(e){let t=e.indexOf("#"),r=e.indexOf("?"),a=r>-1&&(t<0||r<t);return a||t>-1?{pathname:e.substring(0,a?r:t),query:a?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return r}})},9203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"pathHasPrefix",{enumerable:!0,get:function(){return i}});let a=r(1193);function i(e,t){if("string"!=typeof e)return!1;let{pathname:r}=(0,a.parsePath)(e);return r===t||r.startsWith(t+"/")}},8200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removePathPrefix",{enumerable:!0,get:function(){return i}});let a=r(9203);function i(e,t){if(!(0,a.pathHasPrefix)(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[271,571],()=>r(8342));module.exports=a})();